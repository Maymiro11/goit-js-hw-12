{"version":3,"file":"commonHelpers.js","sources":["../src/img/izitoast-icon.svg","../src/img/izitoast-close.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__ee849f36__\"","export default \"__VITE_ASSET__40276dd1__\"","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from \"axios\";\n\nimport errorIcon from '../src/img/izitoast-icon.svg';\nimport closeIcon from '../src/img/izitoast-close.svg';\n\nconst lightbox = new SimpleLightbox('.gallery a', { scrollZoom: false });\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoader = document.querySelector('.btn-load');\n\nlet query;\nlet currentPage = 1;\nlet totalPages = 0;\nconst PAGE_SIZE = 15;\n\nform.addEventListener('submit', onFormSubmit);\n\nasync function fetchImg(query) {\nif (query.trim() === '') return;\n\n  const BASE_URL = 'https://pixabay.com/api/?';\n  const PARAMS = new URLSearchParams({\n    key: '42172991-e7a3268a8ccb87dfba8d5efbc',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    currentPage: currentPage,\n    per_page: 15,\n  });\n  const url = BASE_URL + PARAMS;\n\ntry {\n    const response = await axios.get(url);\n    return response.data;\n} catch (error) {\n    console.error('Error fetching data', error);\n    throw error;\n}\n}\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  currentPage = 1;\n  query = document.querySelector('input[type=\"text\"]').value.trim();\n\n  if (query !== '') {\n    loader.classList.remove('hidden');\n    btnLoader.classList.remove('hidden');\n\n    try {\n        const data = await fetchImg(query);\n        console.log('Кількість зображень:', data.totalHits);\n    \n        if (data.hits.length === 0) {\n          iziToast.show({\n            messageAlign: 'center',\n            message:\n              'Sorry, there are no images matching <br> your search query. Please try again!',\n            messageColor: '#FFFFFF',\n            messageSize: '16px',\n            position: 'center',\n            backgroundColor: '#EF4040',\n            progressBarColor: '#B51B1B',\n            iconUrl: errorIcon,\n            displayMode: 'replace',\n            close: false,\n            closeOnEscape: true,\n            pauseOnHover: false,\n            buttons: [\n              [\n                `<button type=\"button\" style=\"background-color: transparent;\"><img src=${closeIcon}></button>`,\n                function (instance, toast) {\n                  instance.hide({ transitionOut: 'fadeOut' }, toast);\n                },\n              ],\n            ],\n          });\n\n          form.reset();\n        } else {\n          gallery.innerHTML = imagesTemplate(data.hits);\n\n          lightbox.refresh();\n          btnLoader.classList.remove('hidden');\n        }\n      } catch (error) {\n            console.error('Error fetching data:', error)\n      } finally {\n        loader.classList.add('hidden');\n      }\n  }\n}\nfunction imagesTemplate(hits) {\n  return hits.map(imgTemplate).join('');\n}\n\nfunction imgTemplate(hit) {\n  return `<li class=\"gallery-card\">\n<a href=\"${hit.largeImageURL}\" data-lightbox=\"image\">\n    <img class=\"gallery-image\"\n    src=\"${hit.webformatURL}\" alt=\"${hit.tags}\">\n</a>\n<div class=\"details\">\n    <p><strong>Likes:</strong> ${hit.likes}</p>\n    <p><strong>Views:</strong> ${hit.views}</p>\n    <p><strong>Comments:</strong> ${hit.comments}</p>\n    <p><strong>Downloads:</strong> ${hit.downloads}</p>\n</div>\n</li>`;\n}\nbtnLoader.addEventListener('click', onButtonClick);\n\nasync function onButtonClick() {\n  currentPage += 1;\n\ntry {\n    const data = await fetchImg(query);\n\n    if (data.totalHits <= currentPage * 15) {\n        btnLoader.classList.add('hidden');\n        iziToast.show({\n            messageAlign: 'center',\n            message: 'We\\'re sorry, but you\\'ve reached the end of search results.',\n            messageColor: '#FFFFFF',\n            messageSize: '16px',\n            position: 'center',\n            backgroundColor: '#EF4040',\n            progressBarColor: '#B51B1B',\n            iconUrl: errorIcon,\n            displayMode: 'replace',\n            close: false,\n            closeOnEscape: true,\n            pauseOnHover: false,\n            buttons: [\n              [\n                `<button type=\"button\" style=\"background-color: transparent;\"><img src=${closeIcon}></button>`,\n                function (instance, toast) {\n                  instance.hide({ transitionOut: 'fadeOut' }, toast);\n                },\n              ],\n            ],\n          });\n\n      } else {\n        gallery.insertAdjacentHTML('beforeend', imagesTemplate(data.hits));\n\n        lightbox.refresh();\n        }\n    } catch (error) {\n        console.error('Error fetching data:', error)\n    } finally  {\n      loader.style.display = 'none';\n    }\n}\n//SCROLL\n\n\n\n//кнопка лоадер\n\nasync function loadMore() {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const data = await fetchImg(query);\n    gallery.insertAdjacentHTML('beforeend', imagesTemplate(data.hits));\n    updateStatusObserver();\n\n    if (currentPage >= totalPages) {\n      btnLoader.classList.add('hidden');\n    }\n  } catch (error) {\n    console.error('Error fetching data:', error);\n  } finally {\n    hideLoader();\n    window.scrollBy({\n      top: 578,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction updateStatusObserver() {\n  const isLastPage = currentPage >= totalPages;\n  if (isLastPage) {\n    observer.unobserve(refs.targetElem);\n    console.log('The end!');\n  } else { \n    observer.observe(refs.targetElem);\n  }\n}\n\nconst callback = function (entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      loadMore();\n    }\n  });\n};\n\nlet observer = new IntersectionObserver(callback);\n\n// =====================================\n\nfunction showLoader() {\n  refs.loaderElem.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loaderElem.classList.add('hidden');\n}"],"names":["errorIcon","closeIcon","lightbox","SimpleLightbox","form","gallery","loader","btnLoader","query","currentPage","totalPages","onFormSubmit","fetchImg","BASE_URL","PARAMS","url","axios","error","data","iziToast","instance","toast","imagesTemplate","hits","imgTemplate","hit","onButtonClick","loadMore","showLoader","updateStatusObserver","hideLoader","observer","callback","entries","entry"],"mappings":"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"}